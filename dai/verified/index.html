<!DOCTYPE html>
<html>
  <head>
    <title>Threelab</title>
    <script src="https://www.gstatic.com/firebasejs/5.9.2/firebase.js"></script>
    <script>
      function getParameterByName(name, url) {
        if (!url) url = window.location.href;
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
          results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return "";
        return decodeURIComponent(results[2].replace(/\+/g, " "));
      }

      function handleVerifyEmail(auth, actionCode, continueUrl, lang) {
        auth
          .applyActionCode(actionCode)
          .then(function(resp) {
            document.getElementById("response").innerHTML =
              "E-mail verificado!";
          })
          .catch(function(error) {
            document.getElementById("response").innerHTML =
              "Error al verificar el e-mail";
          });
      }

      document.addEventListener(
        "DOMContentLoaded",
        function() {
          var mode = getParameterByName("mode");
          var actionCode = getParameterByName("oobCode");
          var continueUrl = getParameterByName("continueUrl");
          var lang = getParameterByName("lang") || "en";

          var config = {
            apiKey: "AIzaSyCJy2qD-0y07hLqKDBgA4nxbugmDfNCkSo"
          };
          var app = firebase.initializeApp(config);
          var auth = app.auth();

          switch (mode) {
            case "verifyEmail":
              handleVerifyEmail(auth, actionCode, continueUrl, lang);
              break;
            default:
          }
        },
        false
      );
    </script>
    <style></style>
  </head>
  <body>
    <p id="response"></p>
  </body>
</html>
